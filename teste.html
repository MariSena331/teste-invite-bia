<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Confirmar de Presença</title>

    <!-- Tipografia: Open Sans Regular (400) e Bold (700) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --card-radius: 14px;
        --card-border: #e5e7eb;
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        --ok-bg: #ecfdf5;
        --ok-bd: #a7f3d0;
        --ok-fg: #065f46;
        --er-bg: #fef2f2;
        --er-bd: #fecaca;
        --er-fg: #991b1b;
        --btn-red: #dc2626; /* vermelho */
        --btn-red-hover: #b91c1c;
        --measure: 46ch; /* largura “menor” usada pelo campo e pela mensagem */
      }

      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: "Open Sans", system-ui, -apple-system, Segoe UI, Roboto,
          Arial, sans-serif;
        font-weight: 400;
        color: #0f172a;
        background: transparent; /* para se misturar ao Google Sites */
      }

      .container {
        max-width: 1100px;
        margin: 24px auto;
        padding: 0 16px;
        display: grid;
        grid-template-columns: 1fr minmax(520px, 560px);
        gap: 40px;
        align-items: start;
      }

      /* imagem decorativa à esquerda */
      .art {
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .art img {
        width: 100%;
        max-width: 520px;
        height: auto;
        display: block;
        filter: drop-shadow(0 6px 16px rgba(0, 0, 0, 0.12));
      }

      /* cartão do formulário */
      .card {
        background: #fff;
        border: 0; /* <<< sem borda ao redor do formulário */
        border-radius: var(--card-radius);
        /* box-shadow: var(--shadow); */
        padding: 22px;
      }

      h1 {
        font-size: 1.55rem;
        line-height: 1.3;
        margin: 0 0 12px 0;
        font-weight: 700; /* Open Sans Bold */
      }

      label {
        display: block;
        font-weight: 400;
        margin: 14px 0 6px;
      }

      /* Campo de nome: largura menor, igual à “measure” (também usada na última linha e na mensagem) */
      .measure {
        max-width: var(--measure);
      }
      input[type="text"] {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #d1d5db;
        border-radius: 10px;
        font: inherit;
        outline: none;
      }
      input[type="text"]:focus {
        border-color: #9ca3af;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
      }

      /* radio */
      .row {
        display: flex;
        gap: 20px;
        margin: 10px 0 8px;
        flex-wrap: wrap;
      }
      .opt {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      /* botão vermelho */
      button {
        margin-top: 14px;
        padding: 10px 16px;
        border: 0;
        border-radius: 10px;
        background: var(--btn-red);
        color: #fff;
        font-weight: 400;
        cursor: pointer;
      }
      button:hover {
        background: var(--btn-red-hover);
      }
      button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      /* mensagens */
      .msg {
        margin-top: 14px;
        padding: 10px;
        border-radius: 10px;
        font-weight: 400;
        display: none;
      }
      .ok {
        background: var(--ok-bg);
        color: var(--ok-fg);
        border: 1px solid var(--ok-bd);
      }
      .err {
        background: var(--er-bg);
        color: var(--er-fg);
        border: 1px solid var(--er-bd);
      }

      .help {
        color: #6b7280;
        font-size: 0.95rem;
        margin-top: 8px;
      }

      /* responsivo */
      @media (max-width: 980px) {
        .container {
          grid-template-columns: 1fr;
        }
        .art {
          order: -1;
        } /* imagem acima no mobile */
        .art img {
          max-width: 380px;
          margin: 0 auto;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Lado esquerdo: imagem decorativa -->
      <div class="art" aria-hidden="true">
        <img
          src="https://logodownload.org/wp-content/uploads/2013/12/apple-logo-1-2.png"
          alt=""
        />
      </div>

      <!-- Lado direito: cartão do formulário -->
      <div class="card">
        <h1>Confirmar de Presença</h1>

        <form id="rsvpForm" novalidate>
          <div class="measure">
            <label for="name">Nome e Sobrenome</label>
            <input
              id="name"
              name="name"
              type="text"
              placeholder="Ex.: Ana Clara Santos"
              required
            />
          </div>

          <label style="margin-top: 16px">Você vai comparecer?</label>
          <div class="row" role="radiogroup" aria-label="Você vai comparecer?">
            <label class="opt">
              <input type="radio" name="answer" value="Sim" required />
              <span>Sim</span>
            </label>
            <label class="opt">
              <input type="radio" name="answer" value="Não" required />
              <span>Não</span>
            </label>
          </div>

          <button id="submitBtn" type="submit">Enviar</button>

          <!-- mensagem com a mesma largura do campo de nome -->
          <div id="message" class="msg measure"></div>

          <p class="help measure">
            Obs.: o nome deve constar na lista de convidados.
          </p>
        </form>
      </div>
    </div>

    <!-- Integração com Apps Script -->
    <script>
      const form = document.getElementById("rsvpForm");
      const btn = document.getElementById("submitBtn");
      const box = document.getElementById("message");

      function showMsg(text, type) {
        box.textContent = text;
        box.className = "msg measure " + (type === "ok" ? "ok" : "err");
        box.style.display = "block";
      }

      form.addEventListener("submit", function (e) {
        e.preventDefault();
        box.style.display = "none";

        const name = (document.getElementById("name").value || "").trim();
        const answer = new FormData(form).get("answer") || "";

        if (!name || !answer) {
          showMsg("Preencha nome completo e selecione Sim/Não.", "err");
          return;
        }

        btn.disabled = true;
        btn.textContent = "Enviando...";

        // Chama a função do Code.gs
        google.script.run
          .withSuccessHandler((res) => {
            if (res && res.found) {
              showMsg("Resposta registrada com sucesso!", "ok");
              form.reset();
            } else {
              showMsg("Você não está na lista.", "err");
            }
            btn.disabled = false;
            btn.textContent = "Enviar";
          })
          .withFailureHandler((err) => {
            showMsg(
              err && err.message
                ? err.message
                : "Erro ao enviar. Tente novamente.",
              "err"
            );
            btn.disabled = false;
            btn.textContent = "Enviar";
          })
          .submitRsvp({ name, answer });
      });
    </script>
  </body>
</html>
